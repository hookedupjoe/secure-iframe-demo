<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="css/app-styles.css" rel="stylesheet">

    <title>Secure Inner-Frame Demo</title>

    <body>

        

        <div class="container">

<a onclick="sendMessage('hello');return false;" href="javascript:void(0)">Send Hello</a>

            <div class="starter-template">
                <h1>I Am In An IFrame</h1>
                <p id="outarea" class="lead"></p>
            </div>

        </div>
        <!-- /.container -->


        <script src="lib/jquery/jquery.min.js"></script>
        
        <script>
           
            function App() {
                this.parentport = 7002
                this.outarea = $("#outarea");

                this.receiveMessage = function(event) {
                    if( event.origin !== 'http://localhost:' + app.parentport){
                        console.error("Received message from invalid source")
                        app.outarea.html("Received message from invalid source " + event.origin );
                        return;
                    }
                    var eventData = event.data;
                    app.outarea.html("GOT MESSAGE from " + event.origin + "<br />msg: " + eventData.name || 'unknown');
                };
                this.sendMessage = function(iFrameElem, message) {
                    iFrameElem.contentWindow.postMessage(message, 'http://localhost:' + app.parentport);
                };
                this.addListeners = function() {
                    window.addEventListener("message", jQuery.proxy(this.receiveMessage, this), false);
                };
            };
            // Initializing the global app when ready
            var app;
            $( document ).ready(function() {
                app = new App();
                app.addListeners()
            });

            function sendMessage(theMsg){
				window.parent.postMessage({name: theMsg}, '*');
			}



			
        </script>


    </body>

</html>